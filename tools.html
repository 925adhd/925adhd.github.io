<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tools</title>
  
  <!-- PWA Meta Tags -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#56C3AE">
  <link rel="stylesheet" href="assets/layout.css?v=20260101">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="925 ADHD">
  <link rel="apple-touch-icon" href="https://img1.wsimg.com/isteam/ip/e5c52ac6-7189-421d-9701-bbc6d6a027fc/SmartSelect_20241218_055052_Gallery.png">
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://img1.wsimg.com/isteam/ip/e5c52ac6-7189-421d-9701-bbc6d6a027fc/SmartSelect_20241218_055052_Gallery.png">

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --bg: #0F0F0F;
      --card: #1A1A1A;
      --card-hover: #242424;
      --border: rgba(255,255,255,.1);
      --text: #fff;
      --text-muted: rgba(255,255,255,.55);
      --brand: #56C3AE;
      --brand-glow: rgba(86, 195, 174, 0.25);
    }
    
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      padding-bottom: 80px;
    }
    
    a { color: inherit; text-decoration: none; }
    
    /* Header */
    .header {
      background: var(--brand);
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .header h1 { font-size: 18px; font-weight: 700; color: #0F0F0F; }
    
    .back-btn {
      position: absolute;
      left: 16px;
      background: none;
      border: none;
      color: #0F0F0F;
      font-size: 20px;
      cursor: pointer;
      padding: 4px 8px;
    }
    
    /* Main Content */
    .main-content {
      padding: 12px 12px 20px;
      max-width: 700px;
      margin: 0 auto;
    }

    /* Updated Badge */
    .updated-badge {
      color: var(--brand);
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }

    /* Brain.fm Hero */
    .hero-card {
      background: transparent;
      border: none;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 16px;
    }

    .hero-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .hero-logo {
      width: 56px;
      height: 56px;
      border-radius: 12px;
      object-fit: cover;
      border: none;
    }
    
    .hero-info { flex: 1; }
    
    .favorite-badge {
      display: inline-block;
      background: transparent;
      color: var(--brand);
      font-size: 12px;
      font-weight: 700;
      padding: 0;
      border-radius: 0;
      margin-bottom: 6px;
      border: none;
    }
    .favorite-badge .fav-text, .favorite-badge .heart { display: inline; }
    @media (max-width: 520px) {
      .favorite-badge .fav-text, .favorite-badge .heart { display: none; }
    }
    
    .hero-info h2 {
      font-size: 17px;
      font-weight: 800;
      margin-bottom: 2px;
    }

    .hero-info p {
      font-size: 12px;
      color: var(--text-muted);
    }

    .audio-player {
      margin-bottom: 12px;
    }
    
    .audio-player audio {
      width: 100%;
      height: 44px;
      border-radius: 8px;
    }
    
    .hero-text p {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    /* Secondary hero copy: slightly smaller and muted to de-emphasize navigation */
    .hero-text .muted-note {
      font-size: 11px;
      opacity: 0.65;
      color: var(--text);
      margin-bottom: 4px;
    }

    /* Reduce spacing specifically under the final hero paragraph (Brain.fm link) */
    .hero-text p:last-of-type {
      margin-bottom: 0px;
    }
    
    .hero-text .highlight {
      color: #ffffff; /* make white */
      font-weight: 700;
      text-decoration: none; /* no underline */
    }
    
    .hero-text a {
      color: var(--brand);
      text-decoration: underline;
    }
    
    /* Category tabs removed */
    
    /* Section */
    .section { margin-bottom: 20px; }
    .section-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
      background: transparent;
      color: var(--text);
      padding: 0;
      border-radius: 0;
      border: none;
      backdrop-filter: none;
    }

    .section-title .emoji { font-size: 16px; }
    
    /* Tools Grid */
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      align-items: start;
      justify-items: center;
    }

    /* Make a single tool span the full row and center it visually */
    .tools-grid .full-width-center {
      grid-column: 1 / -1;
      justify-self: stretch;
      max-width: none;
      text-align: left;
      padding-top: 0;
      padding-bottom: 0;
      width: 100%;
    }
    
    .tool-card {
      background: transparent;
      border: none;
      border-radius: 0;
      padding: 0;
      text-align: center;
      transition: none;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .tool-card:hover {
      transform: none;
      box-shadow: none;
    }
    
    .tool-icon {
      width: 100px;
      height: 100px;
      border-radius: 12px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      overflow: hidden;
      background: transparent;
    }
    
    .tool-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
      display: block;
    }

    /* Sleep icon: match default tool icon sizing and spacing for consistent look */
    .tool-card.sleep-tool .tool-icon {
      width: 100px;
      height: 100px;
      margin-bottom: 8px;
    }
    .tool-card.sleep-tool .tool-icon img { width: 100%; height: 100%; }

    .tool-icon img.small-logo {
      width: 72px;
      height: 72px;
      object-fit: cover;
      border-radius: 8px;
      display: block;
      margin: 0 auto;
    }

    .tool-card h3 {
      font-size: 13px;
      font-weight: 900;
      margin-bottom: 2px;
      line-height: 1.1;
      letter-spacing: 0.2px;
    }

    .tool-card p {
      font-size: 9px;
      color: rgba(255,255,255,0.55);
      line-height: 1.2;
      margin: 0;
      margin-top: 2px;
      max-width: 140px;
    }

    /* Passion Finder Card Styling */
    .passion-finder-card {
      background: rgba(86, 195, 174, 0.08) !important;
      border: 1px solid rgba(86, 195, 174, 0.2) !important;
      border-radius: 10px !important;
      padding: 10px 12px !important;
      flex-direction: row !important;
      align-items: center !important;
      text-align: left !important;
      justify-content: flex-start !important;
      margin-bottom: 12px !important;
    }

    .passion-finder-content {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      justify-content: flex-start;
    }

    .passion-icon {
      flex-shrink: 0;
      margin-bottom: 0 !important;
      width: 52px !important;
      height: 52px !important;
    }

    .passion-icon img {
      width: 52px !important;
      height: 52px !important;
    }

    .passion-text {
      flex: 1;
      text-align: left;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .passion-text h3 {
      font-size: 13px !important;
      font-weight: 700 !important;
      margin-bottom: 1px !important;
      text-align: left !important;
    }

    .passion-text p {
      font-size: 10px !important;
      color: rgba(255, 255, 255, 0.4) !important;
      max-width: none !important;
      text-align: left !important;
      margin: 0 !important;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .passion-text p::after {
      content: '‚Üí';
      font-size: 12px;
      opacity: 0.6;
    }

    /* Game Card */
    .game-card {
      background: linear-gradient(135deg, #6c5ce7 0%, #a855f7 100%);
      border-radius: 12px;
      padding: 6px 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 8px;
      transition: all 0.12s;
    }
    
    .game-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(108, 92, 231, 0.4);
    }
    
    .game-card-content {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .game-card-icon { font-size: 32px; }
    
    .game-card h3 {
      font-size: 14px;
      font-weight: 700;
      margin: 0;
    }
    
    .game-card-arrow {
      font-size: 24px;
      font-weight: 300;
      opacity: 0.8;
    }
    
    /* Info Card */
    .info-card {
      background: rgba(86, 195, 174, 0.08);
      border: 1px solid rgba(86, 195, 174, 0.2);
      border-radius: 10px;
      padding: 10px 12px;
      margin-bottom: 10px;
    }

    .info-card p {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 0;
      line-height: 1.4;
    }

    .info-card p:last-child { margin-bottom: 0; }
    
    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #111;
      border-top: 1px solid var(--border);
      padding: 8px 0;
      padding-bottom: max(8px, env(safe-area-inset-bottom));
      z-index: 1000;
    }
    
    .nav-items {
      display: flex;
      justify-content: space-around;
      align-items: center;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      padding: 6px 10px;
      color: var(--text-muted);
      font-size: 10px;
      font-weight: 600;
    }
    
    .nav-item.active { color: var(--brand); }
    .nav-item:hover { color: var(--text); }
    .nav-item .icon { font-size: 20px; }
    
    .hidden { display: none !important; }

    /* Mobile-specific compact mode */
    @media (max-width: 420px) {
      .main-content {
        padding: 8px 8px 16px;
      }

      .hero-card {
        padding: 8px;
        margin-bottom: 12px;
      }

      .hero-logo {
        width: 48px;
        height: 48px;
      }

      .hero-info h2 {
        font-size: 15px;
      }

      .hero-info p {
        font-size: 11px;
      }

      .tool-icon {
        width: 80px;
        height: 80px;
        margin-bottom: 6px;
      }

      .tool-card h3 {
        font-size: 12px;
      }

      .tool-card p {
        font-size: 8px;
      }

      .section {
        margin-bottom: 16px;
      }

      .section-title {
        font-size: 13px;
        margin-bottom: 8px;
      }

      .tools-grid {
        gap: 10px;
      }
    }

    @media (min-width: 600px) {
      .main-content { padding: 28px 24px; }
      .tools-grid { gap: 16px; }
      .tool-icon { width: 140px; height: 140px; font-size: 56px; }
      .tool-icon img.small-logo { width: 110px; height: 110px; }
      .tool-card h3 { font-size: 13px; }
      .tool-card p { font-size: 11px; }
      .hero-logo { width: 80px; height: 80px; }
      .audio-player { margin-top: 12px; }
    }

    /* Desktop: keep the Passion Finder full-width across all screen sizes */
    @media (min-width: 900px) {
      .tools-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
      .tools-grid .full-width-center { grid-column: 1 / -1; justify-self: stretch; }
    }

    /* Premium Overlay Styles */
    .premium-required {
      position: relative;
      filter: brightness(0.7);
      cursor: not-allowed !important;
    }

    .premium-required::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.12), rgba(251, 191, 36, 0.04));
      border-radius: 10px;
      pointer-events: none;
      z-index: 1;
    }

    .premium-banner {
      position: absolute;
      top: 8px;
      right: 8px;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0F0F0F;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 9px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      z-index: 2;
      box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
      pointer-events: none;
    }

    .premium-banner::before {
      content: '‚≠ê ';
    }

    .section.premium-section {
      opacity: 0.6;
      position: relative;
    }

    .section.premium-section::before {
      content: 'üîí Premium Feature - Upgrade to Unlock';
      display: block;
      text-align: center;
      background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(251, 191, 36, 0.05));
      border: 1px solid rgba(251, 191, 36, 0.3);
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 16px;
      font-size: 13px;
      font-weight: 700;
      color: #fbbf24;
    }
  </style>
</head>
<body data-page-title="Tools">
  <div id="site-header"></div>
  
  <main class="main-content">
    
    <!-- Brain.fm Hero -->
    <section class="hero-card">
      <div class="hero-header">
        <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/gGKdFr4xAr4dXt6XV3rg/Logo%20(multicolored%20backround).png" alt="Brain.fm" class="hero-logo">
        <div class="hero-info">
          <span class="favorite-badge" aria-label="Favorite"><span class="heart">‚ù§</span><span class="fav-text"> Favorite</span></span>
          <h2>Brain.fm</h2>
          <p>ADHD focus music backed by science!</p>
        </div>
      </div>
      
      <!-- Custom Audio Player Component -->
      <style>
        /* Custom Audio Player Styles */
        .custom-audio-player {
          background: #1a1a1a;
          border-radius: 25px;
          padding: 12px 16px;
          display: flex;
          align-items: center;
          gap: 12px;
          margin-bottom: 16px;
        }

        .audio-play-btn {
          background: none;
          border: none;
          color: #fff;
          cursor: pointer;
          padding: 0;
          width: 24px;
          height: 24px;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-shrink: 0;
        }

        .audio-play-btn svg {
          width: 20px;
          height: 20px;
          fill: #fff;
        }

        .audio-time {
          font-size: 13px;
          color: #fff;
          font-family: system-ui, -apple-system, sans-serif;
          min-width: 75px;
          flex-shrink: 0;
        }

        .audio-progress-container {
          flex: 1;
          height: 4px;
          background: #666;
          border-radius: 2px;
          cursor: pointer;
          position: relative;
        }

        .audio-progress-bar {
          height: 100%;
          background: #999;
          border-radius: 2px;
          width: 0%;
          transition: width 0.1s linear;
        }

        .audio-controls-right {
          display: flex;
          align-items: center;
          gap: 8px;
          flex-shrink: 0;
        }

        .audio-volume-btn {
          background: none;
          border: none;
          color: #fff;
          cursor: pointer;
          padding: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .audio-volume-btn svg {
          width: 20px;
          height: 20px;
          fill: #fff;
        }

        .audio-menu-btn {
          background: none;
          border: none;
          color: #fff;
          cursor: pointer;
          padding: 4px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 18px;
          line-height: 1;
        }

        .audio-menu-btn svg {
          width: 20px;
          height: 20px;
          fill: #fff;
        }
      </style>

      <div class="custom-audio-player">
        <!-- Play/Pause Button -->
        <button class="audio-play-btn" id="playPauseBtn" aria-label="Play">
          <svg viewBox="0 0 24 24" id="playIcon">
            <path d="M8 5v14l11-7z"/>
          </svg>
          <svg viewBox="0 0 24 24" id="pauseIcon" style="display: none;">
            <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
          </svg>
        </button>
        
        <!-- Time Display -->
        <span class="audio-time"><span id="currentTime">0:00</span> / <span id="duration">0:00</span></span>
        
        <!-- Progress Bar -->
        <div class="audio-progress-container" id="progressContainer">
          <div class="audio-progress-bar" id="progressBar"></div>
        </div>
        
        <!-- Volume & Menu -->
        <div class="audio-controls-right">
          <button class="audio-volume-btn" id="volumeBtn" aria-label="Mute">
            <svg viewBox="0 0 24 24" id="volumeOnIcon">
              <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
            </svg>
            <svg viewBox="0 0 24 24" id="volumeOffIcon" style="display: none;">
              <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
            </svg>
          </button>
          <button class="audio-menu-btn" aria-label="More options">
            <svg viewBox="0 0 24 24">
              <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Hidden actual audio element -->
      <audio id="brainAudio" preload="metadata">
        <source src="https://www.dropbox.com/scl/fi/5vkgpt2hsrj2rhkxbomy3/Geode-Grooves-Focus-Deep-Work.wav?rlkey=bku0yamcro88yuipv4b2ed675&st=hchol8mj&raw=1" type="audio/wav">
      </audio>

      <script>
      (function() {
        const audio = document.getElementById('brainAudio');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playIcon = document.getElementById('playIcon');
        const pauseIcon = document.getElementById('pauseIcon');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const progressBar = document.getElementById('progressBar');
        const progressContainer = document.getElementById('progressContainer');
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeOnIcon = document.getElementById('volumeOnIcon');
        const volumeOffIcon = document.getElementById('volumeOffIcon');

        function formatTime(seconds) {
          if (isNaN(seconds)) return '0:00';
          const mins = Math.floor(seconds / 60);
          const secs = Math.floor(seconds % 60);
          return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        audio.addEventListener('loadedmetadata', () => {
          durationEl.textContent = formatTime(audio.duration || 0);
        });

        playPauseBtn.addEventListener('click', () => {
          if (audio.paused) audio.play(); else audio.pause();
        });

        audio.addEventListener('play', () => {
          playIcon.style.display = 'none';
          pauseIcon.style.display = 'block';
        });

        audio.addEventListener('pause', () => {
          playIcon.style.display = 'block';
          pauseIcon.style.display = 'none';
        });

        audio.addEventListener('timeupdate', () => {
          const percent = (audio.currentTime / (audio.duration || 1)) * 100;
          progressBar.style.width = `${percent}%`;
          currentTimeEl.textContent = formatTime(audio.currentTime);
        });

        progressContainer.addEventListener('click', (e) => {
          const rect = progressContainer.getBoundingClientRect();
          const percent = (e.clientX - rect.left) / rect.width;
          audio.currentTime = percent * (audio.duration || 0);
        });

        volumeBtn.addEventListener('click', () => {
          audio.muted = !audio.muted;
          volumeOnIcon.style.display = audio.muted ? 'none' : 'block';
          volumeOffIcon.style.display = audio.muted ? 'block' : 'none';
        });

        if ('mediaSession' in navigator) {
          try {
            navigator.mediaSession.metadata = new MediaMetadata({
              title: 'Focus',
              artist: 'Brain.Fm',
              album: '',
              artwork: [{ src: document.querySelector('.hero-logo')?.src || '', sizes: '512x512', type: 'image/png' }]
            });
            navigator.mediaSession.setActionHandler('play', () => audio.play());
            navigator.mediaSession.setActionHandler('pause', () => audio.pause());
          } catch (e) { /* ignore */ }
        }
      })();
      </script>

    <div class="hero-text">
        <p>Press play. Focus kicks in around <span class="highlight">5 minutes</span>.</p>

        <p class="muted-note">üòµ‚Äçüí´ Tired of this same song?</p>
        <p class="muted-note"><a href="https://www.brain.fm/925adhd" target="_blank" style="text-decoration:none">üîó Try Brain.fm</a> ‚Äî <span class="highlight" style="color: #ffffff">1 month free</span> (affiliate link)</p>
      </div>
    </section>
    
    <!-- Category tabs removed -->
    
    <!-- Productivity Tools -->
    <section class="section" data-category="productivity">
      <h2 class="section-title" aria-label="Productivity"></h2>
      <div class="tools-grid">
        <a href="https://925adhd.github.io/memberpages/Passionfinder.html" class="tool-card full-width-center passion-finder-card" data-show-only="all" target="_blank">
          <div class="passion-finder-content">
            <div class="tool-icon passion-icon">
              <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/V9fFmHmj0sNrFWEZxvre.png" alt="Passion Finder" onerror="this.parentElement.innerHTML='üß†'">
            </div>
            <div class="passion-text">
              <h3>Passion Finder Quiz</h3>
              <p>Discover what excites you!</p>
            </div>
          </div>
        </a>
        
        <a href="dailyschedule.html" class="tool-card premium-tool">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/7HwiSh3EDujCj29qgiUm.png" alt="Daily Schedule" onerror="this.parentElement.innerHTML='üìÖ'">
          </div>
          <h3>Daily Schedule</h3>
          <p>Structure tasks, boost daily flow</p>
        </a>

        <a href="hourlyoptimizer.html" class="tool-card premium-tool">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/wBhoYHSa5Q04KK4FKtXE.png" alt="Hourly Optimizer" onerror="this.parentElement.innerHTML='üïê'">
          </div>
          <h3>Hourly Optimizer</h3>
          <p>Maximize focus every hour</p>
        </a>
      </div>
    </section>
    <script>
      (function(){
        const brainAudio = document.getElementById('brainAudio');
        if (!brainAudio) return;
        const originalTitle = document.title || 'Tools';
        const trackTitle = 'Focus - Brain.Fm';
        const artworkUrl = document.querySelector('.hero-logo')?.src || '';

        function setPlaying() {
          try { document.title = trackTitle; } catch(e){}
          if ('mediaSession' in navigator) {
            try {
              navigator.mediaSession.metadata = new MediaMetadata({
                title: 'Focus',
                artist: 'Brain.Fm',
                album: '',
                artwork: artworkUrl ? [{ src: artworkUrl, sizes: '512x512', type: 'image/png' }] : []
              });
              navigator.mediaSession.playbackState = 'playing';
            } catch(e){}
          }
        }

        function onPause() {
          if ('mediaSession' in navigator) {
            try { navigator.mediaSession.playbackState = 'paused'; } catch(e){}
          }
        }

        function onEnded() {
          try { document.title = originalTitle; } catch(e){}
          if ('mediaSession' in navigator) {
            try { navigator.mediaSession.playbackState = 'none'; } catch(e){}
          }
        }

        brainAudio.addEventListener('play', setPlaying);
        brainAudio.addEventListener('playing', setPlaying);
        brainAudio.addEventListener('pause', onPause);
        brainAudio.addEventListener('ended', onEnded);
      })();
    </script>
    
    <!-- Money Tools -->
    <section class="section premium-section" data-category="money">
      <h2 class="section-title" aria-label="Money Management"></h2>
      <div class="tools-grid">
        <a href="gigtracker.html" class="tool-card">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/BdMduJSDImXq22qq3v3m.png" alt="Earnings Tracker" onerror="this.parentElement.innerHTML='üíµ'">
          </div>
          <h3>Earnings Tracker</h3>
          <p>Monitor income & progress</p>
        </a>
        
        <a href="freelancecalc.html" class="tool-card">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/doTXb9E6rkYYbYQZbgkq.png" alt="Freelance Calculator" onerror="this.parentElement.innerHTML='üßÆ'">
          </div>
          <h3>Freelance Calculator</h3>
          <p>Estimate rates & plan goals</p>
        </a>
        
        <a href="receiptstacker.html" class="tool-card">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/uakfmOX6h8gm1CT9YMpc.png" alt="Receipt Stacking" onerror="this.parentElement.innerHTML='üßæ'">
          </div>
          <h3>Receipt Stacking</h3>
          <p>Multiply cashback rewards</p>
        </a>
        
        <a href="essentials.html" class="tool-card">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/5Xaz4x2wv7VWpHIGXX9Q.png" alt="Gig Work Essentials" onerror="this.parentElement.innerHTML='üéß'">
          </div>
          <h3>Gig Essentials</h3>
          <p>Core tools for freelancing</p>
        </a>
      </div>
    </section>
    
    <!-- Wellness Tools -->
    <section class="section premium-section" data-category="wellness">
      <h2 class="section-title" aria-label="Wellness and Focus"></h2>
      <div class="info-card">
        <p>üåø Take care of yourself first. These tools help you reset, reframe, and refocus when your brain needs a break.</p>
      </div>
      <div class="tools-grid">
        <a href="breathwork.html" class="tool-card">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/LEknNOXuweNmn1ki5uUj.png" alt="Breathwork Studio" onerror="this.parentElement.innerHTML='ü´Å'">
          </div>
          <h3>Breathwork Studio</h3>
          <p>Guided breathing exercises</p>
        </a>
        
        <a href="mindshift.html" class="tool-card">
          <div class="tool-icon">
            <img src="https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/bIquIPZf7ZEXDA4vlm8R/pub/qww1P1UZ8Fd2VXf9iCmm.png" alt="Mindshift" onerror="this.parentElement.innerHTML='üí≠'">
          </div>
          <h3>Mindshift</h3>
          <p>Reframe negative thoughts</p>
        </a>
        
        <a href="sleepcalc.html" class="tool-card sleep-tool">
          <div class="tool-icon">
            <img src="images/sleepicon.png" alt="Sleep Calculator" onerror="this.parentElement.innerHTML='üò¥'">
          </div>
          <h3>Sleep Calculator</h3>
          <p>Time your sleep cycles for better mornings</p>
        </a>
        
        <!-- Brain.fm card removed (hero at top is primary) -->
      </div>
    </section>
    
    <!-- Fun Section -->
    <section class="section premium-section" data-category="fun">
      <h2 class="section-title" aria-label="Game Break"></h2>
      <div class="info-card">
        <p>üïπÔ∏è Sometimes you just need a quick dopamine hit. Take a break, then get back to it!</p>
      </div>
      <a href="gir.html" class="game-card">
        <div class="game-card-content">
          <span class="game-card-icon">üëæ</span>
          <h3>ADHD Space Adventure</h3>
        </div>
        <span class="game-card-arrow">‚Ä∫</span>
      </a>
    </section>
  </main>
  
  <div id="site-nav"></div>

  <script src="assets/layout.js?v=20260101"></script>

  <script>
    // Category tab filtering
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        // Update active tab
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const category = btn.dataset.category;
        
        // Show/hide sections
        document.querySelectorAll('.section').forEach(section => {
          if (category === 'all' || section.dataset.category === category) {
            section.classList.remove('hidden');
          } else {
            section.classList.add('hidden');
          }
        });

        // Show/hide any elements that declare they should only appear for a specific tab
        document.querySelectorAll('[data-show-only]').forEach(el => {
          const only = el.dataset.showOnly;
          if (!only) return;
          if (category === only) el.classList.remove('hidden'); else el.classList.add('hidden');
        });
      });
    });
  </script>

  <!-- Premium Gate Script -->
  <script src="assets/api-config.js"></script>
  <script src="assets/auth-helper.js"></script>
  <script>
    // All API keys are now securely stored on the backend

    async function checkPremiumStatus() {
      const { session } = await secureAuth.getSession();

      if (!session) {
        // Not logged in - redirect to login
        window.location.href = 'index.html';
        return;
      }

      // Check membership status through secure backend
      const { data: memberData, error } = await secureAuth.checkMembership(session.user.email);

      // Store premium status globally (defaults to false if not found)
      const isPremium = memberData?.isPremium || false;
      window.isPremium = isPremium;

      // Always call applyPremiumGates - it will either remove or add gates based on premium status
      applyPremiumGates();
    }

    function applyPremiumGates() {
      if (window.isPremium) {
        // Premium users: remove all gates and restore normal appearance
        document.querySelectorAll('.premium-tool').forEach(tool => {
          tool.classList.remove('premium-required');
        });

        document.querySelectorAll('.premium-section').forEach(section => {
          section.classList.remove('premium-section');
        });
        return;
      }

      // Non-premium users: apply gates
      // Gate individual premium tools
      document.querySelectorAll('.premium-tool').forEach(tool => {
        tool.classList.add('premium-required');
        const banner = document.createElement('div');
        banner.className = 'premium-banner';
        banner.textContent = 'Premium';
        tool.appendChild(banner);

        tool.addEventListener('click', (e) => {
          e.preventDefault();
          showUpgradePrompt(tool.querySelector('h3')?.textContent || 'This feature');
        });
      });

      // Make premium sections clickable to show upgrade
      document.querySelectorAll('.premium-section').forEach(section => {
        section.style.cursor = 'pointer';
        section.addEventListener('click', (e) => {
          e.preventDefault();
          const sectionName = section.querySelector('h2')?.getAttribute('aria-label') || 'These tools';
          showUpgradePrompt(sectionName);
        });

        // Prevent links in premium sections from working
        section.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
          });
        });
      });
    }

    function showUpgradePrompt(featureName) {
      const promptHTML = `
        <div style="position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(8px);" id="upgradePrompt">
          <div style="background: linear-gradient(135deg, #1a1a1a, #0f0f0f); border: 1px solid rgba(251,191,36,0.3); border-radius: 16px; padding: 32px 24px; max-width: 400px; width: 100%; text-align: center; box-shadow: 0 8px 32px rgba(251,191,36,0.2);">
            <div style="font-size: 48px; margin-bottom: 16px;">‚≠ê</div>
            <h2 style="font-size: 22px; margin-bottom: 12px; color: #fbbf24;">Premium Feature</h2>
            <p style="color: rgba(255,255,255,0.7); margin-bottom: 24px; font-size: 14px;">
              ${featureName} is available to Premium members. Upgrade to unlock exclusive features and support the continued development of 925 ADHD.
            </p>
            <div style="display: flex; gap: 12px; flex-direction: column;">
              <a href="https://buy.stripe.com/bJebJ2djL1dgfwx5YA7Zu06"
                style="background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #0f0f0f; padding: 14px 24px; border-radius: 10px; font-weight: 700; text-decoration: none; font-size: 15px; display: block;">
                Upgrade to Premium - $5/mo
              </a>
              <div>
                <button onclick="document.getElementById('upgradePrompt').remove()"
                  style="background: transparent; border: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.7); padding: 12px 24px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 14px; width: 100%;">
                  Maybe Later
                </button>
                <p style="margin-top: 8px; font-size: 11px; color: rgba(255,255,255,0.4); text-align: center;">Cancel anytime. No pressure.</p>
              </div>
            </div>
          </div>
        </div>
      `;
      document.body.insertAdjacentHTML('beforeend', promptHTML);
    }

    // Check premium status on page load
    checkPremiumStatus();
  </script>
</body>
</html>
